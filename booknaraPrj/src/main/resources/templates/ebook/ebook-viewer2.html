<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ebook Viewer Mock</title>
  <style>
    :root{
      --bg:#ffffff;
      --page:#ffffff;
      --paper-border:#cfcfcf;
      --ink:#222;
      --muted:#6b7280;
      --panel:#fbf5ea;
      --panel-border:#eadfcf;
      --card:#ffffff;
      --card-border:#e6e1d8;
      --shadow: 0 10px 30px rgba(0,0,0,.08);
      --shadow-soft: 0 8px 20px rgba(0,0,0,.06);
      --accent:#f3b23b;
      --accent-2:#f0c96b;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background:#111; /* ë°”ê¹¥ì€ ì–´ë‘ìš´ ë°°ê²½(ì‘ì€ í™”ë©´ì—ì„œ ìŠ¤í¬ë¡¤ë  ë•Œ) */
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
      color:var(--ink);
      overflow:auto; /* 1920x1080 ê³ ì • ìº”ë²„ìŠ¤ê°€ í™”ë©´ë³´ë‹¤ í¬ë©´ ìŠ¤í¬ë¡¤ */
    }

    /* 1920x1080 â€œìº”ë²„ìŠ¤â€ */
    .viewport{
      width:1920px;
      height:1080px;
      background:var(--bg);
      margin:0 auto;
      position:relative;
      overflow:hidden;
    }

    /* ë©”ì¸ ë ˆì´ì•„ì›ƒ */
    .main{
      position:absolute;
      inset:0;
      display:grid;
      grid-template-columns: 1fr 360px; /* ë³¸ë¬¸ + ìš°ì¸¡ íŒ¨ë„ */
    }

    /* ====== Reader area ====== */
    .reader{
      position:relative;
      padding:24px 24px 18px 24px;
      overflow:hidden;
    }

    /* ìƒë‹¨ ë°”(ì˜¤ë²„ë ˆì´ ë•Œë§Œ ë³´ì„) */
    .top-tools{
      position:absolute;
      top:18px;
      right:18px;
      display:flex;
      align-items:center;
      gap:10px;
      opacity:0;
      pointer-events:none;
      transform: translateY(-6px);
      transition: opacity .18s ease, transform .18s ease;
      z-index:50;
    }
    .viewer.overlay-on .top-tools{
      opacity:1;
      pointer-events:auto;
      transform: translateY(0);
    }
    .tool-btn{
      width:34px;
      height:34px;
      border-radius:10px;
      border:1px solid rgba(0,0,0,.08);
      background:rgba(255,255,255,.85);
      box-shadow:var(--shadow-soft);
      display:grid;
      place-items:center;
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, background .15s ease;
    }
    .tool-btn:hover{ transform: translateY(-1px); background:rgba(255,255,255,.95); }
    .tool-btn:active{ transform: translateY(0); }
    .tool-btn svg{ width:18px; height:18px; opacity:.86; }

    /* ì¢…ì´(í˜ì´ì§€) */
    .paper{
      height:100%;
      border:1px solid var(--paper-border);
      background:var(--page);
      box-shadow: 0 8px 22px rgba(0,0,0,.06);
      position:relative;
      padding:34px 36px 78px 36px;
    }

    .paper-header{
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      font-size:12px;
      color:var(--muted);
      margin-bottom:14px;
    }

    .columns{
      height:calc(100% - 24px);
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:38px;
      overflow:hidden;
    }
    .col{
      font-size:14px;
      line-height:1.8;
      color:#1f2937;
      overflow:hidden;
    }
    .col p{ margin:0 0 12px 0; }

    /* í•˜ë‹¨ ì§„í–‰ë°” + í˜ì´ì§€ */
    .paper-footer{
      position:absolute;
      left:36px;
      right:36px;
      bottom:18px;
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      align-items:center;
      gap:14px;
      font-size:12px;
      color:var(--muted);
    }
    .progress-wrap{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .progress{
      height:4px;
      flex:1;
      background:rgba(0,0,0,.08);
      border-radius:999px;
      overflow:hidden;
    }
    .progress > i{
      display:block;
      height:100%;
      width:0%;
      background:linear-gradient(90deg, var(--accent), var(--accent-2));
      border-radius:999px;
      transition: width .18s ease;
    }
    .page-indicator{
      justify-self:center;
      font-variant-numeric: tabular-nums;
      color:#374151;
    }

    /* ë§ˆìŠ¤ì½”íŠ¸(ì¢Œí•˜ë‹¨) */
    .mascot{
      position:absolute;
      left:18px;
      bottom:20px;
      width:64px;
      height:64px;
      border-radius:16px;
      background:rgba(255,255,255,.9);
      border:1px solid rgba(0,0,0,.1);
      box-shadow:var(--shadow-soft);
      display:grid;
      place-items:center;
      z-index:30;
      user-select:none;
    }
    .mascot span{
      font-size:34px;
      transform: translateY(1px);
    }

    /* ====== Nav Arrows ====== */
    .nav-arrow{
      position:absolute;
      top:50%;
      transform: translateY(-50%);
      width:64px;
      height:64px;
      border-radius:18px;
      border:1px solid rgba(0,0,0,.12);
      background:rgba(255,255,255,.86);
      box-shadow:var(--shadow);
      display:grid;
      place-items:center;
      cursor:pointer;
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease, background .18s ease;
      z-index:60;
    }
    .nav-arrow:hover{ background:rgba(255,255,255,.95); }
    .nav-arrow:active{ transform: translateY(-50%) scale(.98); }
    .nav-arrow.left{ left:28px; }
    .nav-arrow.right{ right:28px; }

    .nav-arrow svg{ width:30px; height:30px; opacity:.88; }

    /* ì˜¤ë²„ë ˆì´ ONì´ë©´ í•­ìƒ ë³´ì´ê²Œ */
    .viewer.overlay-on .nav-arrow{
      opacity:1;
      pointer-events:auto;
    }
    /* ê¸°ë³¸ ìƒíƒœì—ì„œëŠ” â€œê°€ì¥ìë¦¬ ê·¼ì²˜â€ì—ì„œë§Œ ë³´ì´ê²Œ */
    .viewer.edge-left .nav-arrow.left,
    .viewer.edge-right .nav-arrow.right{
      opacity:1;
      pointer-events:auto;
    }

    /* ====== Overlay dim (ì„ íƒ) ====== */
    .dim{
      position:absolute;
      inset:0;
      background:rgba(0,0,0,.02);
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease;
      z-index:40;
    }
    .viewer.overlay-on .dim{
      opacity:1;
      pointer-events:auto; /* dim í´ë¦­ìœ¼ë¡œ ì˜¤ë²„ë ˆì´ ë‹«ê¸° */
    }

    /* ====== TTS Controls ====== */
    .tts{
      position:absolute;
      left:50%;
      bottom:128px;
      transform: translateX(-50%) translateY(10px);
      width:360px;
      border-radius:16px;
      border:1px solid rgba(0,0,0,.12);
      background:rgba(255,255,255,.88);
      box-shadow:var(--shadow);
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      z-index:70;
      padding:14px 14px 10px 14px;
      backdrop-filter: blur(6px);
    }
    .viewer.overlay-on .tts{
      opacity:1;
      pointer-events:auto;
      transform: translateX(-50%) translateY(0);
    }
    .tts .row{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:12px;
      padding:4px 0 8px 0;
    }
    .tts .btn{
      width:44px;
      height:44px;
      border-radius:14px;
      border:1px solid rgba(0,0,0,.12);
      background:#fff;
      display:grid;
      place-items:center;
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, background .15s ease;
    }
    .tts .btn:hover{ background:#fffdf7; transform: translateY(-1px); }
    .tts .btn:active{ transform: translateY(0); }
    .tts .btn svg{ width:20px; height:20px; opacity:.85; }
    .tts .speed{
      display:flex;
      justify-content:center;
      gap:10px;
      font-size:12px;
      color:#4b5563;
      padding-top:2px;
    }
    .chip{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(0,0,0,.10);
      background:rgba(255,255,255,.9);
      cursor:pointer;
      user-select:none;
    }
    .chip.active{
      border-color: rgba(243,178,59,.65);
      box-shadow: 0 0 0 3px rgba(243,178,59,.18);
    }

    /* ====== Right Panel ====== */
    .side{
      background:var(--panel);
      border-left:1px solid var(--panel-border);
      padding:18px 16px;
      overflow:auto;
    }
    .side .stack{
      display:flex;
      flex-direction:column;
      gap:14px;
    }
    .modal_overlay{
      background:rgba(255,255,255,.55);
      border:1px solid rgba(0,0,0,.06);
      border-radius:14px;
      padding:12px;
      box-shadow: var(--shadow-soft);
    }
    .modal_overlay h3{
      margin:0 0 10px 0;
      font-size:13px;
      color:#374151;
      letter-spacing:-.2px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    .modal_overlay h3 small{
      font-weight:600;
      color:#9ca3af;
    }

    /* TOC */
    .toc ul{ list-style:none; padding:0; margin:0; }
    .toc li{
      padding:8px 10px;
      border-radius:10px;
      cursor:pointer;
      color:#374151;
      font-size:13px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .toc li:hover{ background:rgba(255,255,255,.65); }
    .toc li.active{
      background:rgba(255,255,255,.85);
      border:1px solid rgba(0,0,0,.06);
    }
    .toc .dot{
      width:18px;
      height:18px;
      border-radius:999px;
      background:rgba(243,178,59,.25);
      display:grid;
      place-items:center;
      font-size:11px;
      color:#8a5a00;
      flex:none;
    }

    /* ====== Dictionary panel (ê¾¸ë¯¸ê¸° ê°•í™”) ====== */
    .dict-card{
      background:var(--card);
      border:1px solid var(--card-border);
      border-radius:14px;
      padding:12px;
      box-shadow: 0 6px 16px rgba(0,0,0,.06);
    }
    .dict_modal_head{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      margin-bottom:8px;
    }
    .headword{
      font-size:18px;
      font-weight:800;
      letter-spacing:-.2px;
      line-height:1.1;
      margin:0;
    }
    .phon{
      margin-top:4px;
      font-size:12px;
      color:var(--muted);
      display:flex;
      gap:8px;
      align-items:center;
    }
    .pill{
      font-size:11px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(0,0,0,.10);
      background:#fff;
      color:#4b5563;
    }
    .dict-actions{
      display:flex;
      gap:8px;
      align-items:center;
    }
    .icon-mini{
      width:30px; height:30px;
      border-radius:10px;
      border:1px solid rgba(0,0,0,.10);
      background:#fff;
      display:grid;
      place-items:center;
      cursor:pointer;
      transition: transform .08s ease, background .15s ease;
      flex:none;
    }
    .icon-mini:hover{ background:#fffdf7; transform: translateY(-1px); }
    .icon-mini svg{ width:16px; height:16px; opacity:.82; }

    .modal_li{
      margin-top:10px;
      padding-top:10px;
      border-top:1px solid rgba(0,0,0,.06);
    }
    .modal_li h4{
      margin:0 0 8px 0;
      font-size:12px;
      color:#374151;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .speech{
      font-size:11px;
      padding:2px 7px;
      border-radius:999px;
      background:rgba(243,178,59,.20);
      border:1px solid rgba(243,178,59,.35);
      color:#7a4d00;
    }
    .dict_modal_body{
      margin:0;
      padding-left:16px;
      color:#374151;
      font-size:13px;
      line-height:1.55;
    }
    .dict_modal_body li{ margin:6px 0; }
    .dict-foot{
      margin-top:10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      font-size:11px;
      color:#9ca3af;
    }

    /* Settings panel mock */
    .settings .row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:8px 10px;
      border-radius:12px;
      background:rgba(255,255,255,.55);
      border:1px solid rgba(0,0,0,.05);
      margin-bottom:8px;
    }
    .settings .label{
      font-size:12px;
      color:#374151;
    }
    .settings .seg{
      display:flex;
      gap:6px;
      align-items:center;
    }
    .seg button{
      border:1px solid rgba(0,0,0,.10);
      background:#fff;
      border-radius:10px;
      padding:6px 8px;
      font-size:12px;
      cursor:pointer;
    }
    .seg button:hover{ background:#fffdf7; }
    .slider{
      width:160px;
    }

    /* My books mock */
    .books .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .book{
      background:#fff;
      border:1px solid rgba(0,0,0,.08);
      border-radius:12px;
      padding:8px;
      box-shadow: 0 6px 14px rgba(0,0,0,.05);
      display:flex;
      gap:8px;
    }
    .cover{
      width:42px;
      height:56px;
      border-radius:10px;
      background:linear-gradient(135deg, rgba(0,0,0,.08), rgba(0,0,0,.02));
      border:1px solid rgba(0,0,0,.08);
      flex:none;
    }
    .book .meta{
      min-width:0;
    }
    .book .title{
      font-size:12px;
      font-weight:700;
      margin:0 0 4px 0;
      color:#374151;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .book .sub{
      margin:0;
      font-size:11px;
      color:#9ca3af;
    }

    /* í´ë¦­ ì˜ì—­ íŒíŠ¸ ì œê±° */
    .paper, .reader { user-select:none; }
    .col { user-select:text; } /* ë³¸ë¬¸ í…ìŠ¤íŠ¸ëŠ” ì„ íƒ ê°€ëŠ¥ */

    /* ì ‘ê·¼ì„± */
    button, .tool-btn, .nav-arrow, .icon-mini, .tts .btn { outline:none; }
    .sr-only{
      position:absolute;
      width:1px;height:1px;
      padding:0;margin:-1px;
      overflow:hidden;clip:rect(0,0,0,0);
      white-space:nowrap;border:0;
    }
  </style>
</head>

<body>
<div class="viewport viewer" id="viewer">
  <div class="main">
    <!-- LEFT: Reader -->
    <section class="reader" id="reader">
      <div class="dim" id="dim"></div>

      <!-- Top tools (bookmark ì œê±°ë¨) -->
      <div class="top-tools" aria-label="ë„êµ¬">
        <div class="tool-btn" title="ëª©ì°¨">
          <!-- list -->
          <svg viewBox="0 0 24 24" fill="none"><path d="M8 6h13M8 12h13M8 18h13M3 6h1M3 12h1M3 18h1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
        <div class="tool-btn" title="í…ìŠ¤íŠ¸ ì„¤ì •">
          <!-- text -->
          <svg viewBox="0 0 24 24" fill="none"><path d="M4 6h16M8 6v14m8-14v14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
        <div class="tool-btn" title="í…Œë§ˆ">
          <!-- sun -->
          <svg viewBox="0 0 24 24" fill="none"><path d="M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12Z" stroke="currentColor" stroke-width="2"/><path d="M12 2v2m0 16v2M4 12H2m20 0h-2M5 5l1.4 1.4M17.6 17.6 19 19M19 5l-1.4 1.4M6.4 17.6 5 19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
        <div class="tool-btn" title="TTS">
          <!-- speaker -->
          <svg viewBox="0 0 24 24" fill="none"><path d="M11 5 6 9H3v6h3l5 4V5Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/><path d="M16 9a4 4 0 0 1 0 6m2.5-8.5a7 7 0 0 1 0 11" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
      </div>

      <!-- Paper -->
      <div class="paper" id="paper">
        <div class="paper-header">
          <div>ì „ìì±… Â· ë„ì„œê´€ ë¬´ë£ŒëŒ€ì—¬ í”„ë¡œì íŠ¸</div>
          <div>ì½ê¸° ëª¨ë“œ</div>
        </div>

        <div class="columns" id="columns">
          <div class="col" id="colL"></div>
          <div class="col" id="colR"></div>
        </div>

        <div class="paper-footer">
          <div class="progress-wrap">
            <div class="progress" aria-label="ì§„í–‰ë¥ "><i id="progressBar"></i></div>
          </div>
          <div class="page-indicator" id="pageIndicator">1/270</div>
          <div style="text-align:right;">
            <span style="color:#9ca3af;">í‚¤ë³´ë“œ:</span> â† â†’ í˜ì´ì§€
          </div>
        </div>
      </div>

      <!-- mascot -->
      <div class="mascot" title="ë§ˆìŠ¤ì½”íŠ¸"><span>ğŸ“š</span></div>

      <!-- nav arrows -->
      <div class="nav-arrow left" id="btnPrev" role="button" aria-label="ì´ì „ í˜ì´ì§€">
        <svg viewBox="0 0 24 24" fill="none"><path d="M15 18 9 12l6-6" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
      <div class="nav-arrow right" id="btnNext" role="button" aria-label="ë‹¤ìŒ í˜ì´ì§€">
        <svg viewBox="0 0 24 24" fill="none"><path d="m9 18 6-6-6-6" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>

      <!-- TTS floating controls -->
      <div class="tts" aria-label="TTS ì»¨íŠ¸ë¡¤">
        <div class="row">
          <div class="btn" title="ì´ì „ ë¬¸ì¥">
            <svg viewBox="0 0 24 24" fill="none"><path d="M6 5v14M18 7l-8 5 8 5V7Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/></svg>
          </div>
          <div class="btn" id="ttsPlay" title="ì¬ìƒ/ì¼ì‹œì •ì§€">
            <svg id="ttsIcon" viewBox="0 0 24 24" fill="none"><path d="M8 5v14l11-7L8 5Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/></svg>
          </div>
          <div class="btn" title="ë‹¤ìŒ ë¬¸ì¥">
            <svg viewBox="0 0 24 24" fill="none"><path d="M18 5v14M6 7l8 5-8 5V7Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/></svg>
          </div>
        </div>
        <div class="speed" aria-label="ì¬ìƒ ì†ë„">
          <div class="chip" data-speed="0.5">0.5</div>
          <div class="chip active" data-speed="1.0">1.0</div>
          <div class="chip" data-speed="2.0">2.0</div>
        </div>
      </div>

    </section>

    <!-- RIGHT: Side panels -->
    <aside class="side" aria-label="ìš°ì¸¡ íŒ¨ë„">
      <div class="stack">
        <!-- TOC -->
        <div class="panel toc">
          <h3>ëª©ì°¨ <small>TOC</small></h3>
          <ul id="tocList">
            <li class="active"><span><span class="dot">1</span> 1ì¥</span><span>â€º</span></li>
            <li><span><span class="dot">2</span> 2ì¥</span><span>â€º</span></li>
            <li><span><span class="dot">3</span> 3ì¥</span><span>â€º</span></li>
            <li><span><span class="dot">4</span> 4ì¥</span><span>â€º</span></li>
            <li><span><span class="dot">5</span> 5ì¥</span><span>â€º</span></li>
          </ul>
        </div>

        <!-- Dictionary (êµ¬ì„± ìœ ì§€ + ìŠ¤íƒ€ì¼ ê°œì„ ) -->
        <div id="dict_modal_overlay" class="modal_overlay">
          <h3>ì‚¬ì „ <small>Dictionary</small></h3>

          <div class="dict-card">
            <div class="dict_modal_head">
              <div>
                <p class="headword">whale</p>
                <div class="phon">
                  <span class="pill">/weÉªl/</span>
                  <span class="pill">noun</span>
                </div>
              </div>
              <div class="dict-actions">
                <div class="icon-mini" title="ë°œìŒ ë“£ê¸°">
                  <svg viewBox="0 0 24 24" fill="none"><path d="M11 5 6 9H3v6h3l5 4V5Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/><path d="M16 9a4 4 0 0 1 0 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                </div>
                <div class="icon-mini" title="ë‹«ê¸°(ì˜ˆì‹œ)">
                  <svg viewBox="0 0 24 24" fill="none"><path d="M6 6l12 12M18 6 6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                </div>
              </div>
            </div>

            <ul class="modal_ul">
              <li class="modal_li">
                <h4><span class="speech">ëœ»</span> Meaning</h4>
                <ol class="dict_modal_body">
                  <li>ê³ ë˜(í° í•´ì–‘ í¬ìœ ë¥˜)</li>
                  <li>(ë¹„ìœ ) ì•„ì£¼ í° ì‚¬ëŒ/ë¬¼ê±´</li>
                  <li>(ì¹´ì§€ë…¸) í°ì†</li>
                </ol>
              </li>
            </ul>

            <div class="dict-foot">
              <span>ì˜ˆë¬¸/ì¶”ê°€ ì •ë³´ ì˜ì—­(êµ¬ì„± ìœ ì§€)</span>
              <span>CC BY-SA 3.0</span>
            </div>
          </div>
        </div>

        <!-- Settings -->
        <div class="panel settings">
          <h3>ì„¤ì • <small>Style</small></h3>

          <div class="row">
            <div class="label">ë°°ê²½</div>
            <div class="seg">
              <button type="button" data-theme="light">ë°ê²Œ</button>
              <button type="button" data-theme="sepia">ì„¸í”¼ì•„</button>
              <button type="button" data-theme="dark">ì–´ë‘¡ê²Œ</button>
            </div>
          </div>

          <div class="row">
            <div class="label">ê¸€ì í¬ê¸°</div>
            <input class="slider" id="fontSize" type="range" min="12" max="20" value="14" />
          </div>

          <div class="row" style="margin-bottom:0;">
            <div class="label">ì¤„ê°„ê²©</div>
            <input class="slider" id="lineHeight" type="range" min="1.4" max="2.2" step="0.1" value="1.8" />
          </div>
        </div>

        <!-- My books -->
        <div class="panel books">
          <h3>ë‚´ ì „ìì±… <small>Library</small></h3>
          <div class="grid">
            <div class="book">
              <div class="cover"></div>
              <div class="meta">
                <p class="title">The Old Manâ€¦</p>
                <p class="sub">ì½ëŠ” ì¤‘</p>
              </div>
            </div>
            <div class="book">
              <div class="cover"></div>
              <div class="meta">
                <p class="title">Sherlockâ€¦</p>
                <p class="sub">ëŒ€ì—¬ ê°€ëŠ¥</p>
              </div>
            </div>
          </div>
        </div>

      </div>
    </aside>
  </div>
</div>

<script>
  // ====== Mock book data (í˜ì´ì§€ë³„ í…ìŠ¤íŠ¸) ======
  const totalPages = 270;
  let currentPage = 20; // ìŠ¤í¬ë¦°ìƒ· ëŠë‚Œ(20/270)
  const viewer = document.getElementById("viewer");
  const reader = document.getElementById("reader");
  const dim = document.getElementById("dim");

  const colL = document.getElementById("colL");
  const colR = document.getElementById("colR");
  const pageIndicator = document.getElementById("pageIndicator");
  const progressBar = document.getElementById("progressBar");

  const btnPrev = document.getElementById("btnPrev");
  const btnNext = document.getElementById("btnNext");

  const EDGE_THRESHOLD = 120; // â€œì¼ì •ê±°ë¦¬â€ (px) - í•„ìš”í•˜ë©´ ì¡°ì ˆ

  const sampleParagraphs = [
    "1651ë…„ë¶€í„° 1687ë…„ê¹Œì§€ê°€ ì‘í’ˆì˜ ì‹œê°„ì  ë°°ê²½ì´ë‹¤. ì‰ê¸€ëœë“œ ê³µêµ­ íƒœìƒì˜ ì„ ì› ë¡œë¹ˆìŠ¨ í¬ë£¨ì†Œê°€ ì›ì£¼ë¯¼ê³¼ì˜ ê±°ë˜ë¥¼ ìœ„í•´ í•­í•´ì— ë‚˜ì„°ë‹¤ê°€ ë¬´ì¸ë„ì— í‘œë¥˜í•´ ì‚´ê²Œ ëœë‹¤.",
    "ê·¸ëŠ” íŒŒì†ëœ ë°°ì—ì„œ í•„ìš”í•œ ë„êµ¬ì™€ ì‹ëŸ‰ì„ ì˜®ê²¨ì˜¤ê³ , ê±°ì£¼ì§€ë¥¼ ì •ë¹„í•˜ë©° ìƒì¡´ ê¸°ë°˜ì„ ë§ˆë ¨í•œë‹¤. ì‹œê°„ì´ íë¥´ë©° ì„¬ì˜ í™˜ê²½ì— ì ì‘í•˜ê³ , ìŠ¤ìŠ¤ë¡œë¥¼ ë‹¤ìŠ¤ë¦¬ëŠ” ë²•ì„ ë°°ìš´ë‹¤.",
    "ì´ ê³¼ì •ì—ì„œ ê·¸ëŠ” ì‚¬ì†Œí•œ ì¼ìƒê³¼ ì„±ì°°ì„ ê¸°ë¡í•˜ê³ , ìì‹ ì˜ ì‚¶ì„ ë‹¤ì‹œ ë°”ë¼ë³´ê²Œ ëœë‹¤. ì–´ëŠ ë‚  ë‚¯ì„  ë°œìêµ­ì„ ë°œê²¬í•˜ë©° ë‘ë ¤ì›€ê³¼ ê¸´ì¥ê°ì´ ì°¾ì•„ì˜¨ë‹¤.",
    "ê·¸ëŠ” ë°©ì–´ì±…ì„ ì„¸ìš°ê³  ì£¼ë³€ì„ ì‚´í”¼ë©° ìœ„í˜‘ì„ ëŒ€ë¹„í•œë‹¤. ê²°êµ­ â€˜í”„ë¼ì´ë°ì´â€™ë¼ ë¶€ë¥¼ ì›ì£¼ë¯¼ì„ êµ¬í•´ë‚´ê³  í•¨ê»˜ ìƒí™œí•˜ë©° ì„œë¡œë¥¼ ì´í•´í•˜ê²Œ ëœë‹¤.",
    "ì™¸ë¶€ ì„¸ê³„ì™€ ë‹¨ì ˆëœ ì±„ ì‹œê°„ì€ í˜ëŸ¬ê°€ê³ , ê·¸ëŠ” êµ¬ì¡°ë  ê¸°íšŒë¥¼ ê¸°ë‹¤ë¦°ë‹¤. ë§ˆì¹¨ë‚´ ì§€ë‚˜ê°€ëŠ” ë°°ì™€ì˜ ì‚¬ê±´ì„ í†µí•´ ì„¬ì„ ë– ë‚  ê°€ëŠ¥ì„±ì´ ì—´ë¦°ë‹¤."
  ];

  function buildPageText(pageNo){
    // ê°„ë‹¨íˆ í˜ì´ì§€ ë²ˆí˜¸ì— ë”°ë¼ í…ìŠ¤íŠ¸ ì¡°ê¸ˆì”© ë³€í˜•(ëª©ì—…)
    const seed = (pageNo % 5);
    const blocks = [];
    for (let i=0;i<8;i++){
      blocks.push(sampleParagraphs[(seed + i) % sampleParagraphs.length]);
    }
    return blocks;
  }

  function renderPage(){
    const blocks = buildPageText(currentPage);
    // 2ë‹¨ ë¶„ë°°(ê°„ë‹¨íˆ ë°˜ë°˜)
    const left = blocks.slice(0, Math.ceil(blocks.length/2));
    const right = blocks.slice(Math.ceil(blocks.length/2));

    colL.innerHTML = left.map(t => `<p>${t}</p>`).join("");
    colR.innerHTML = right.map(t => `<p>${t}</p>`).join("");

    pageIndicator.textContent = `${currentPage}/${totalPages}`;
    progressBar.style.width = `${Math.round((currentPage/totalPages)*100)}%`;
  }

  function clampPage(n){
    if (n < 1) return 1;
    if (n > totalPages) return totalPages;
    return n;
  }

  function goPrev(){
    currentPage = clampPage(currentPage - 1);
    renderPage();
  }
  function goNext(){
    currentPage = clampPage(currentPage + 1);
    renderPage();
  }

  // ====== Overlay toggling (ì¤‘ì•™ í´ë¦­) ======
  let overlayOn = false;

  function setOverlay(on){
    overlayOn = on;
    viewer.classList.toggle("overlay-on", on);

    // ì˜¤ë²„ë ˆì´ê°€ ì¼œì§€ë©´ edge ìƒíƒœ í´ë˜ìŠ¤ëŠ” êµ³ì´ ìœ ì§€í•´ë„ ë˜ì§€ë§Œ,
    // UX ê¹”ë”í•˜ê²Œ í•˜ë ¤ë©´ ì œê±°í•´ë„ OK
    if (on){
      viewer.classList.remove("edge-left","edge-right");
    }
  }

  // â€œì¤‘ì•™ ë¶€ë¶„ í´ë¦­â€ â†’ ì˜¤ë²„ë ˆì´ í† ê¸€
  // (í™”ì‚´í‘œ/ë²„íŠ¼/ìš°ì¸¡ íŒ¨ë„ í´ë¦­ì€ í† ê¸€ ëŒ€ìƒì—ì„œ ì œì™¸)
  function isInteractiveTarget(el){
    return !!el.closest(".nav-arrow, .tts, .top-tools, .side, button, .tool-btn, .icon-mini, input");
  }

  reader.addEventListener("click", (e) => {
    if (isInteractiveTarget(e.target)) return;
    setOverlay(!overlayOn);
  });

  dim.addEventListener("click", () => setOverlay(false));

  // ====== Edge hover arrows (ì˜¤ë²„ë ˆì´ OFF ìƒíƒœì—ì„œë„) ======
  reader.addEventListener("mousemove", (e) => {
    if (overlayOn) return;
    const x = e.clientX; // viewport ê¸°ì¤€
    const w = window.innerWidth;

    const leftOn = x <= EDGE_THRESHOLD;
    const rightOn = x >= (w - EDGE_THRESHOLD);

    viewer.classList.toggle("edge-left", leftOn);
    viewer.classList.toggle("edge-right", rightOn);

    // ì¤‘ì•™ì´ë©´ ë‘˜ ë‹¤ ë„ê¸°
    if (!leftOn) viewer.classList.remove("edge-left");
    if (!rightOn) viewer.classList.remove("edge-right");
  });

  reader.addEventListener("mouseleave", () => {
    if (overlayOn) return;
    viewer.classList.remove("edge-left","edge-right");
  });

  // ====== Mouse arrow click ======
  btnPrev.addEventListener("click", (e) => { e.stopPropagation(); goPrev(); });
  btnNext.addEventListener("click", (e) => { e.stopPropagation(); goNext(); });

  // ====== Keyboard navigation (â†/â†’) ======
  window.addEventListener("keydown", (e) => {
    // ì…ë ¥ ìŠ¬ë¼ì´ë” ì¡°ì‘ ì¤‘ì—” ë°©í•´í•˜ì§€ ì•Šê²Œ
    const tag = (document.activeElement?.tagName || "").toLowerCase();
    if (tag === "input" || tag === "textarea") return;

    if (e.key === "ArrowLeft") { e.preventDefault(); goPrev(); }
    if (e.key === "ArrowRight") { e.preventDefault(); goNext(); }
    if (e.key === "Escape") { setOverlay(false); }
  });

  // ====== Settings controls (ê°„ë‹¨ ëª©ì—…) ======
  const fontSize = document.getElementById("fontSize");
  const lineHeight = document.getElementById("lineHeight");

  fontSize.addEventListener("input", () => {
    const v = fontSize.value;
    colL.style.fontSize = v + "px";
    colR.style.fontSize = v + "px";
  });

  lineHeight.addEventListener("input", () => {
    const v = lineHeight.value;
    colL.style.lineHeight = v;
    colR.style.lineHeight = v;
  });

  // theme buttons
  document.querySelectorAll("[data-theme]").forEach(btn => {
    btn.addEventListener("click", () => {
      const t = btn.dataset.theme;
      if (t === "light"){
        document.documentElement.style.setProperty("--bg", "#ffffff");
        document.documentElement.style.setProperty("--page", "#ffffff");
        document.documentElement.style.setProperty("--ink", "#222");
        document.documentElement.style.setProperty("--panel", "#fbf5ea");
      } else if (t === "sepia"){
        document.documentElement.style.setProperty("--bg", "#fff9ef");
        document.documentElement.style.setProperty("--page", "#fff7e8");
        document.documentElement.style.setProperty("--ink", "#2b2620");
        document.documentElement.style.setProperty("--panel", "#fbf0df");
      } else if (t === "dark"){
        document.documentElement.style.setProperty("--bg", "#0b0f17");
        document.documentElement.style.setProperty("--page", "#0f1623");
        document.documentElement.style.setProperty("--ink", "#e5e7eb");
        document.documentElement.style.setProperty("--panel", "#0f1520");
      }
      // ë³¸ë¬¸ í…ìŠ¤íŠ¸ ì»¬ëŸ¬
      colL.style.color = getComputedStyle(document.documentElement).getPropertyValue("--ink");
      colR.style.color = getComputedStyle(document.documentElement).getPropertyValue("--ink");
    });
  });

  // ====== TTS controls mock ======
  let playing = false;
  const ttsPlay = document.getElementById("ttsPlay");
  const ttsIcon = document.getElementById("ttsIcon");

  function setPlayState(on){
    playing = on;
    ttsIcon.innerHTML = on
      ? '<path d="M7 6v12M17 6v12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>'
      : '<path d="M8 5v14l11-7L8 5Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>';
  }
  ttsPlay.addEventListener("click", (e) => {
    e.stopPropagation();
    setPlayState(!playing);
  });

  document.querySelectorAll(".chip[data-speed]").forEach(chip => {
    chip.addEventListener("click", (e) => {
      e.stopPropagation();
      document.querySelectorAll(".chip[data-speed]").forEach(c => c.classList.remove("active"));
      chip.classList.add("active");
      // ì‹¤ì œ TTS ì—°ê²° ì‹œ ì—¬ê¸°ì„œ rate ë°˜ì˜í•˜ë©´ ë¨
    });
  });

  // ì´ˆê¸° ë Œë”
  renderPage();

  // ê¸°ë³¸ì€ ì˜¤ë²„ë ˆì´ OFF
  setOverlay(false);
  setPlayState(false);
</script>
</body>
</html>
